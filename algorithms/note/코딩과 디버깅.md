# 3장 코딩과 디버깅

## 좋은 코드를 짜기 위한 원칙

### 간결한 코드를 작성하기

코드가 짧을 수록 오타나 단순 버그가 생길 우려가 줄어들고,  
디버깅도 쉬워진다.

프로그래밍 대회에선 작성하는 코드 구조가 매우 단순하고,  
각 변수를 읽고 쓰는 부분이 어디인지가 비교적 명확하기 때문에  
전역 변수를 많이 사용해도 괜찮다.

### 적극적으로 코드 재사용하기

간결한 코드를 작성하기 위한 가장 직접적인 방법은 코드를 모듈화하는 것이다.  
같은 코드가 세 번 이상 등장한다면  
항상 해당 코드를 함수로 분리해 재사용한다는 기본 원칙을 세워두는 것도 좋다.

시간이 없다고 해서 코드를 더 알기 쉽게 고치는 데 주저해서는 안된다.  
당장은 차이점이 없더라도 항상 코드를 깔끔하게 작성하고 유지하는 데 신경을 쓰다 보면  
스스로가 그와 같은 코드에 익숙해지기 때문이다.  
그렇게 되면 다음 번에 코드를 짤 때 처음부터 좀더 간결하게 코딩할 수 있게 된다.

### 표준 라이브러리 공부하기

기본 자료구조, 정렬 등 기초 알고리즘을 직접 작성하는 것은 대표적인 시간 낭비다.  
표준 라이브러리는 셀 수 없을 정도로 많이 사용되고 검증되었기 때문에  
메모리 관리나 정당성 증명에 신경 쓸 필요 없이 편하게 사용할 수 있다.  
필수적으로 알아두어야 한다.

### 항상 같은 형태로 프로그램을 작성하기

대회에서 여러 종류의 코드를 반복적으로 짜게 될 경우가 있는데  
이때 매번 다른 형태로 코드를 작성하면 이는 디버깅 시간으로 연결된다.  
자주 작성하는 알고리즘이나 코드 등에 대해서는 한 번 검증된 코드를 작성하고  
이것만을 꾸준히 사용할 필요가 있다.  
그래야 문제에 더 집중할 수 있기 때문이다.

### 일관적이고 명료한 명명법 사용하기

모호하지 않은 변수명과 함수명을 사용하는 버릇을 들이자.  
모호한 명명법은 가끔 잡아내기 힘든 오류를 만들어낸다.

### 모든 자료를 정규화해서 저장하기

좋은 코드의 또 다른 원칙은 같은 자료를 두 가지 형태로 저장하지 않는 것이다.  
예를 들어 유리수는 항상 약분해 기약 분수로 표현하는 것이 좋다.  
그렇게 하지 않으면 6/9와 2/3를 표현하는 변수가 따로 존재하게 된다.  
또 다른 예로, 각도라면 -30도, 330도 690도가 되겠다.  
이런 식으로 같은 자료가 두 개 이상의 표현을 가지게 되면 미묘한 버그를 만들기 쉽다.

### 코드와 데이터를 분리하기

코드의 논리와 상관 없는 데이터는 가능한 한 분리를 하는 것이 좋다.  
ex)

```
string getMonthName(int month) {
  if(month == 1) return "January";
  if(month == 2) return "February";
  ...
}
위와 같은 함수를 짜는 것을 피하고 아래와 같이 만들어두자.

const string monthName[] = { "January", "February", ...}
```

이런 방식은 항상 코드의 양을 줄여서 실수를 하지 않게 도와준다.

## 자주 하는 실수

### 산술 오버플로

### 배열 범위 밖 원소에 접근

### 일관되지 않은 범위 표현 방식 사용하기

대부분의 프로그래밍 언어는 반 열린 구간(half-open interval)을 사용한다.  
반 열린 구간은 첫번째 값은 집합 안에 포함하고, 다른 하나는 집합 안에 포함하지 않는다.  
범위를 표현할 때 프로그램 내에서 한 가지 방법으로만 표현해야 혼란을 피할 수 있다.

### Off-by-one 오류

계산의 큰 줄기는 맞지만 하나가 모자라거나 하나가 많아 틀리는 코드의 오류를 모두 가리킨다.

```
예)
100미터 담장에 10미터 간격으로 울타리 기둥을 세울 때 기둥이 몇개 필요할까?
정답은 10개가 아니라 11개.

정수 배열 A[]가 주어질 때 A[i]부터 A[j]까지의 평균을 구한다고 할때 합을 얼마로 나눠야 할까?
j-i 가 아니라 j-i+1.
```

이 오류는 반복문에서 < 혹은 > 연산자와 <= 혹은 => 연산자를 혼동하여 원소를 하나 더 적게, 또는 많이 순회하는 경우나
반 열린 구간, 반 닫힌 구간을 서로 혼용해 쓴 경우 흔하게 발생한다.  
이런 오류를 방지할 수 있는 좋은 방법은 최소 입력이 주어졌을 때 이 코드가 어떻게 동작할지를 주의하는 것이다.

### 컴파일러가 잡아주지 못하는 상수 오타

각종 상수를 수를 잘못 입력해서 문제를 잘 풀어 놓고도 오답처리 되는 경우가 종종 있다.

```
대문자, 소문자 실수
오타
0의 개수를 틀리는 등
```

### 스택 오버플로

### 다차원 배열 인덱스 순서 바꿔 쓰기

동적 계획법을 위한 메모이제이션 패턴을 사용할 때 다차원 배열을 사용할 일이 잦은데,  
가능한 특정 배열에 접근하는 위치를 하나로 통일하는 것이 좋다.

### 잘못된 비교 함수 작성

언어 표준라이브러리의 비교 연산이 어떻게 되어있는지 알아두어야 잘못된 비교 함수를 작성하는 일을 피할 수 있다.

### 최소, 최대 예외 잘못 다루기

예외란 말 그대로 우리가 예상한 입력의 규칙에 들어맞지 않는 모든 입력입니다.  
가능한 입력 중 최소 값과 최대 값이 예외가 되는 문제들은 생각 외로 많으므로,  
코드를 짤 때 가장 작은 입력과 가장 큰 입력에 대해 제대로 동작할지를 생각해 보면 오류를 잡을 수 있는 경우가 꽤 있다.

### 연산자 우선순위 잘못 쓰기

연산자 우선순위는 종종 헷갈릴 수 있다. 명시적으로 ()를 사용하자.

### 너무 느린 입출력 방식 선택

입출력의 양이 많다면 어떤 입출력 방식을 선택하는지가 프로그램의 정답 여부를 충분히 바꿔놓을 수 있다.  
입력으로 받거나 출력해야할 변수의 수가 1만개를 넘어가면 긴장하는 것이 좋다.  
자신이 사용하는 언어에서 어떤 입출력 방식이 지원되는지를 확인하고, 어느 쪽이 빠른지를 미리 점검해 두자.

### 변수 초기화 문제

많은 프로그래밍 대회에서는 프로그램을 한 번만 실행하고, 한 번에 여러 개의 입력에 대해 답을 처리하라고 요구한다.  
이때 흔한 실수는 이전 입력에서 사용한 전역 변수 값을 초기화하지 않고 그대로 사용하는 것이다.

## 디버깅과 테스팅

### 디버깅에 관하여

프로그래밍 대회에서 작성하는 코드는 대개 길지 않기 때문에, 소스를 한 줄씩 읽어 내려가며 검증하는 것이 가능하다.  
디버거 없이 프로그램의 버그를 찾아내는 연습을 할 필요가 있다.  
잘 분리된 기능적인 코드는 디버거 없이 눈만으로 검증하기가 비교적 쉽다.

-   작은 입력에 대해 제대로 실행되나 확인하기
-   단정문(assertion)을 쓴다: 주어진 조건이 거짓일 때 오류를 내고 프로그램을 강제 종료시키는 함수 또는 구문. 거짓일 때만 오류를 내므로 프로그램의 내부 상태를 검증할 때 유용하게 쓸 수 있다.
-   프로그램의 계산 중간 결과를 출력한다: 중간 과정 값을 출력하고 자신이 예상하는 바와 맞아 들어가는지 검사하면서 문제 발생 범위를 좁힐 수 있다.

### 테스트에 관하여

프로그래밍 대회 답안을 작성한 이후에는 제출 전 예제 입력을 만들어 가능한 한 많이 테스트하는 것이 좋다.  
가장 작은 입력과 큰 입력을 만들어 넣어보고 시간 안에 실행되는지, 답은 잘 나오는지 테스트 해보는 것이 좋다.

#### 스캐폴딩(scaffolding)

프로그램을 테스트할 때 유용하게 사용할 수 있는 기법.  
다른 코드를 개발할 때 뼈대를 잡기 위해 임시로 사용하는 코드.
물론 스캐폴딩이 코드의 모든 문제를 찾아낼 수 없고,  
자칫하면 소중한 코딩 시간을 잡아먹을 수 있으니 필요한 경우에만 가려서 쓰도록 하자.
