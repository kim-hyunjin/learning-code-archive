# Long Polling 기법이란?

이 프로젝트는 Long Polling 기술을 이해하기 위한 간단한 예제입니다.

## Long Polling의 개념

Long Polling은 클라이언트와 서버 간의 통신 모델 중 하나로, 실시간에 가까운 데이터 전송을 효율적으로 구현하기 위해 사용됩니다. 전통적인 폴링(Polling) 방식의 단점을 보완한 기법입니다.

1.  **요청 (Request)**: 클라이언트는 일반적인 HTTP 요청을 서버에 보냅니다.
2.  **연결 대기 (Hold)**: 서버는 클라이언트의 요청을 받지만, 즉시 응답하지 않습니다. 만약 전송할 새로운 데이터가 없다면, 정해진 타임아웃(Timeout)까지 연결을 열어둔 채로 대기합니다.
3.  **응답 (Response)**:
    *   **데이터 발생 시**: 대기 시간 내에 서버에서 새로운 데이터가 발생하면, 서버는 즉시 해당 데이터를 담아 클라이언트에 응답하고 연결을 종료합니다.
    *   **타임아웃 시**: 정해진 타임아웃까지 새로운 데이터가 없으면, 서버는 빈 응답이나 "데이터 없음" 메시지를 보내 연결을 종료합니다.
4.  **재연결 (Reconnect)**: 클라이언트는 서버로부터 응답을 받는 즉시(데이터 유무와 상관없이) 새로운 요청을 다시 보내 위 과정을 반복합니다.

이러한 방식으로 인해 클라이언트는 불필요한 요청을 계속 보내지 않으면서도, 데이터가 발생했을 때 거의 즉시 수신할 수 있습니다.

## 장점 (Advantages)

*   **준 실시간성 (Near Real-time)**: 데이터가 발생하면 거의 즉시 클라이언트에 전달되므로, 사용자 경험이 좋습니다.
*   **효율성**: 전통적인 폴링처럼 매초마다 불필요한 요청을 보내지 않으므로, 네트워크 트래픽과 서버 부하를 줄일 수 있습니다.
*   **구현의 용이성**: WebSocket이나 SSE(Server-Sent Events)에 비해 기존 HTTP 인프라 위에서 비교적 간단하게 구현할 수 있습니다.

## 단점 (Disadvantages)

*   **서버 리소스 소모**: 각 클라이언트마다 연결을 오랫동안 유지해야 하므로, 동시 접속자 수가 많아지면 서버의 메모리나 스레드 같은 리소스를 많이 소모할 수 있습니다.
*   **완전한 실시간 보장 불가**: 요청과 재연결 사이에 약간의 지연(latency)이 존재할 수 있습니다.
*   **메시지 순서 보장 문제**: 네트워크 상황에 따라 메시지 순서가 꼬이거나 유실될 가능성이 있습니다.

## 사용하면 좋은 경우 (Good Use Cases)

이벤트 발생 빈도가 너무 높지 않지만, 즉각적인 업데이트가 필요할 때 적합합니다.

*   **채팅 애플리케이션**: 새 메시지 알림
*   **실시간 알림**: 소셜 미디어의 새 댓글, 좋아요 알림
*   **상태 업데이트**: 백그라운드 작업의 진행 상태(예: 파일 변환, 작업 완료) 알림

## 사용에 부적합한 경우 (Inappropriate Use Cases)

매우 빈번하고 빠른 데이터 전송이 요구되는 경우에는 다른 기술(주로 WebSocket)이 더 적합합니다.

*   **실시간 온라인 게임**: 플레이어의 위치나 행동을 밀리초 단위로 동기화해야 하는 경우
*   **금융 데이터 스트리밍**: 주식 시세와 같이 데이터가 끊임없이 쏟아지는 경우
*   **실시간 협업 도구**: 여러 사용자의 커서 위치를 동시에 추적하는 경우

## 주의할 점 (Points to Consider)

*   **타임아웃(Timeout) 관리**: 타임아웃을 너무 길게 설정하면 서버 리소스가 고갈될 수 있고, 너무 짧으면 전통적인 폴링과 다를 바 없어집니다. 보통 30~60초 사이로 설정하는 것이 일반적입니다.
*   **서버 확장성(Scalability)**: 동시 접속자 수가 많아질 경우를 대비해 로드 밸런서나 서버 증설 계획이 필요합니다.
*   **프록시 및 방화벽**: 중간에 위치한 프록시 서버나 방화벽이 자체적인 연결 시간제한을 두어 Long Polling 연결을 강제로 끊을 수 있으므로, 관련 설정을 확인해야 합니다.

## 다른 실시간 기술과의 비교 (Comparison with Other Real-time Technologies)

Long Polling은 실시간 웹을 구현하는 여러 기술 중 하나입니다. 대표적인 기술인 WebSocket, Server-Sent Events (SSE)와 비교하면 다음과 같은 특징이 있습니다.

### WebSocket

*   **동작 방식**: 클라이언트와 서버 간에 하나의 TCP 연결을 계속 유지하며, 양방향으로 자유롭게 데이터를 주고받을 수 있습니다. (Full-duplex)
*   **장점**: 매우 빠르고 지연 시간이 거의 없어 완전한 실시간 통신이 가능합니다. HTTP와 다른 독자적인 프로토콜(`ws://`, `wss://`)을 사용해 불필요한 HTTP 헤더 없이 순수 데이터만 전송하므로 효율적입니다.
*   **단점**: 구현이 상대적으로 복잡하고, 오래된 브라우저나 일부 프록시 환경에서는 지원되지 않을 수 있습니다.

### Server-Sent Events (SSE)

*   **동작 방식**: 서버에서 클라이언트로만 데이터를 푸시(Push)하는 단방향 통신입니다. 클라이언트는 `EventSource` API를 통해 구독하고, 서버는 필요할 때마다 데이터를 스트리밍 형태로 보냅니다.
*   **장점**: 구현이 간단하고, HTTP 프로토콜을 그대로 사용하므로 호환성이 좋습니다. 연결이 끊어졌을 때 자동으로 재연결하는 기능이 내장되어 있습니다.
*   **단점**: 서버에서 클라이언트로의 단방향 통신만 가능하므로, 클라이언트가 서버로 데이터를 보내야 하는 경우에는 별도의 HTTP 요청이 필요합니다.

### 기술 비교표

| 구분 | Long Polling | WebSocket | Server-Sent Events (SSE) |
| :--- | :--- | :--- | :--- |
| **연결 방식** | HTTP 요청/응답 기반 | 별도의 WebSocket 프로토콜 | HTTP 스트리밍 |
| **통신 방향** | 단방향 (사실상) | **양방향 (Bidirectional)** | **단방향 (Server -> Client)** |
| **실시간성** | 준 실시간 | **완전한 실시간** | 완전한 실시간 |
| **주요 특징** | 구현이 간단, HTTP 호환 | 낮은 지연, 높은 성능 | 서버->클라이언트 푸시, 자동 재연결 |
| **서버 부하** | 요청마다 연결/종료 반복으로 부하 높음 | 단일 연결 유지로 부하 상대적 낮음 | 단일 연결 유지로 부하 상대적 낮음 |
| **적합한 사례** | 간단한 알림, 채팅 | 실시간 게임, 협업 도구, 금융 | 뉴스 피드, 주식 시세, 상태 업데이트 |

### 어떤 기술을 선택해야 할까?

*   **Long Polling**: 오래된 브라우저까지 지원해야 하거나, 서버 구현을 가장 단순하게 유지하고 싶을 때 좋은 선택입니다.
*   **WebSocket**: 클라이언트와 서버가 **지속적으로 양방향 통신**을 해야 하는 복잡한 애플리케이션에 가장 적합합니다.
*   **SSE**: 서버가 클라이언트에게 **주기적으로 또는 비동기적으로 데이터**를 보내기만 하면 되는 경우(예: 알림, 실시간 뉴스 피드)에 가장 간단하고 효율적인 선택입니다.
